/* Modern Premium Design System */
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");

:root {
  --primary-bg: #0a0e1a;
  --secondary-bg: #131824;
  --card-bg: rgba(25, 32, 48, 0.7);
  --accent-primary: #6366f1;
  --accent-secondary: #8b5cf6;
  --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  --success: #10b981;
  --error: #ef4444;
  --warning: #f59e0b;

  --text-primary: #f1f5f9;
  --text-secondary: #94a3b8;
  --text-muted: #64748b;

  --border-color: rgba(148, 163, 184, 0.1);
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
  --glow: 0 0 20px rgba(99, 102, 241, 0.3);

  --spacing-xs: 0.5rem;
  --spacing-sm: 1rem;
  --spacing-md: 1.5rem;
  --spacing-lg: 2rem;
  --spacing-xl: 3rem;

  --radius-sm: 0.5rem;
  --radius-md: 0.75rem;
  --radius-lg: 1rem;

  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family:
    "Inter",
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    sans-serif;
  background: var(--primary-bg);
  color: var(--text-primary);
  line-height: 1.6;
  min-height: 100vh;
  overflow-x: hidden;
}

body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    radial-gradient(
      circle at 20% 50%,
      rgba(99, 102, 241, 0.1) 0%,
      transparent 50%
    ),
    radial-gradient(
      circle at 80% 80%,
      rgba(139, 92, 246, 0.1) 0%,
      transparent 50%
    );
  z-index: -1;
  animation: pulse 8s ease-in-out infinite;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 0.5;
  }
  50% {
    opacity: 0.8;
  }
}

.app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.app-header {
  padding: var(--spacing-lg) var(--spacing-md);
  text-align: center;
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border-color);
  box-shadow: var(--shadow-md);
}

.app-header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: var(--spacing-xs);
  animation: slideDown 0.6s ease-out;
}

.subtitle {
  color: var(--text-secondary);
  font-size: 1.1rem;
  font-weight: 400;
  animation: fadeIn 0.8s ease-out 0.2s both;
}

.settings-toggle {
  margin-top: var(--spacing-md);
  padding: 0.5rem 1.5rem;
  font-size: 0.875rem;
  background: var(--secondary-bg);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-base);
}

.settings-toggle:hover {
  background: var(--accent-primary);
  border-color: var(--accent-primary);
  transform: translateY(-1px);
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.settings-section {
  padding: var(--spacing-lg);
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border-color);
  box-shadow: var(--shadow-md);
  animation: slideDown 0.3s ease-out;
}

.settings-section h3 {
  font-size: 1.25rem;
  margin-bottom: var(--spacing-md);
  color: var(--text-primary);
  font-weight: 600;
}

.settings-grid {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-md);
  max-width: 600px;
}

.update-endpoint-btn {
  padding: 0.75rem 1.5rem;
  background: var(--accent-primary);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-base);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.update-endpoint-btn:hover {
  background: var(--accent-secondary);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.current-endpoint {
  margin-top: var(--spacing-sm);
  color: var(--text-muted);
  font-size: 0.875rem;
  font-family: 'Fira Code', monospace;
}

.app-main {
  flex: 1;
  padding: var(--spacing-lg);
  max-width: 1600px;
  margin: 0 auto;
  width: 100%;
}

.content-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--spacing-lg);
  animation: fadeIn 0.6s ease-out 0.3s both;
}

@media (max-width: 1024px) {
  .content-grid {
    grid-template-columns: 1fr;
  }
}

.command-section,
.response-section {
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  box-shadow: var(--shadow-md);
  transition:
    transform var(--transition-base),
    box-shadow var(--transition-base);
}

.command-section:hover,
.response-section:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.command-form h2 {
  font-size: 1.75rem;
  margin-bottom: var(--spacing-md);
  color: var(--text-primary);
  font-weight: 600;
}

.form-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-lg);
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
}

.form-group.full-width {
  grid-column: 1 / -1;
}

.form-group label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.form-group input,
.form-group select {
  padding: 0.75rem 1rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 1rem;
  font-family: inherit;
  transition: all var(--transition-base);
}

.search-input {
  font-size: 1rem !important;
  padding: 0.875rem 1rem !important;
  background: var(--secondary-bg) !important;
  border: 2px solid var(--border-color) !important;
}

.search-input:focus {
  border-color: var(--accent-primary) !important;
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15) !important;
}

.command-select {
  min-height: 200px !important;
  font-family: 'Fira Code', monospace !important;
  font-size: 0.875rem !important;
  cursor: pointer;
}

.command-select option {
  padding: 0.5rem;
  cursor: pointer;
}

.command-select option:hover {
  background: var(--accent-primary);
}

.command-count {
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: var(--text-muted);
  font-style: italic;
}

.form-group input:focus,
.form-group select:focus {
  outline: none;
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.form-group input::placeholder {
  color: var(--text-muted);
}

button {
  padding: 0.875rem 1.75rem;
  font-size: 1rem;
  font-weight: 600;
  font-family: inherit;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition-base);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.generate-btn {
  background: var(--accent-gradient);
  color: white;
  width: 100%;
  box-shadow: var(--shadow-sm);
}

.generate-btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md), var(--glow);
}

.generate-btn:active {
  transform: translateY(0);
}

.send-section {
  margin-top: var(--spacing-md);
}

.send-btn {
  background: var(--success);
  color: white;
  width: 100%;
  box-shadow: var(--shadow-sm);
}

.send-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow:
    var(--shadow-md),
    0 0 20px rgba(16, 185, 129, 0.3);
}

.send-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.xml-preview {
  margin-top: var(--spacing-lg);
  padding: var(--spacing-md);
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  animation: slideUp 0.3s ease-out;
}

.xml-preview h3 {
  font-size: 1rem;
  margin-bottom: var(--spacing-sm);
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.xml-preview pre {
  margin: 0;
  overflow-x: auto;
}

.xml-preview code {
  font-family: "Fira Code", "Courier New", monospace;
  font-size: 0.875rem;
  color: var(--accent-primary);
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.response-viewer {
  min-height: 400px;
  display: flex;
  flex-direction: column;
}

.response-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-md);
  flex-wrap: wrap;
  gap: var(--spacing-sm);
}

.response-header h2 {
  font-size: 1.75rem;
  font-weight: 600;
  color: var(--text-primary);
}

.response-controls {
  display: flex;
  gap: var(--spacing-sm);
}

.toggle-btn,
.copy-btn {
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  background: var(--secondary-bg);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}

.toggle-btn:hover,
.copy-btn:hover {
  background: var(--accent-primary);
  border-color: var(--accent-primary);
  transform: translateY(-1px);
}

.response-status {
  display: flex;
  gap: var(--spacing-md);
  margin-bottom: var(--spacing-md);
  flex-wrap: wrap;
}

.status-badge {
  padding: 0.5rem 1rem;
  border-radius: var(--radius-sm);
  font-size: 0.875rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.status-badge.success {
  background: rgba(16, 185, 129, 0.2);
  color: var(--success);
  border: 1px solid var(--success);
}

.status-badge.error {
  background: rgba(239, 68, 68, 0.2);
  color: var(--error);
  border: 1px solid var(--error);
}

.action-label {
  padding: 0.5rem 1rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.xml-display,
.parsed-data-tree {
  flex: 1;
  padding: var(--spacing-md);
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  overflow: auto;
  animation: fadeIn 0.3s ease-out;
  overflow-wrap: break-word;
  word-break: break-all;
}

.xml-display pre {
  margin: 0;
  font-family: 'Fira Code', 'Courier New', monospace;
  font-size: 0.85rem;
  line-height: 1.6;
  white-space: pre-wrap;
  word-break: break-all;
}

.xml-display code {
  color: var(--accent-secondary);
}

/* ── XML tree nodes ───────────────────────────────── */
.xml-node {
  margin-left: calc(var(--depth, 0) * 1.25rem);
  margin-top: 0.4rem;
  border-left: 2px solid rgba(99, 102, 241, 0.25);
  padding-left: 0.75rem;
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.xml-node-header {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.4rem;
  padding: 0.45rem 0.6rem;
  border-radius: var(--radius-sm);
  background: rgba(255, 255, 255, 0.03);
  transition: background var(--transition-fast);
  cursor: default;
  user-select: none;
}

.xml-node-collapsible {
  cursor: pointer;
}

.xml-node-collapsible:hover {
  background: rgba(99, 102, 241, 0.1);
}

.xml-collapse-icon {
  font-size: 0.6rem;
  color: var(--text-muted);
  margin-right: 0.2rem;
}

.xml-tag-name {
  font-family: 'Fira Code', monospace;
  font-size: 0.875rem;
  color: var(--accent-primary);
  font-weight: 600;
  white-space: nowrap;
}

.xml-attrs {
  display: flex;
  flex-wrap: wrap;
  gap: 0.3rem;
}

.xml-attr-badge {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  padding: 0.15rem 0.5rem;
  background: rgba(139, 92, 246, 0.12);
  border: 1px solid rgba(139, 92, 246, 0.25);
  border-radius: 9999px;
  font-size: 0.78rem;
  font-family: 'Fira Code', monospace;
  max-width: 100%;
  overflow-wrap: break-word;
  word-break: break-all;
}

.xml-attr-key {
  color: var(--accent-secondary);
  font-weight: 600;
}

.xml-attr-sep {
  color: var(--text-muted);
}

.xml-attr-val {
  color: var(--text-primary);
  white-space: normal;
  word-break: break-all;
}

.xml-node-text {
  margin-top: 0.25rem;
  margin-left: 0.6rem;
  padding: 0.35rem 0.65rem;
  background: rgba(16, 185, 129, 0.07);
  border-left: 2px solid var(--success);
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  font-size: 0.875rem;
  color: var(--text-primary);
  word-break: break-word;
  white-space: pre-wrap;
}

.xml-children {
  margin-top: 0.2rem;
}

.xml-empty {
  color: var(--text-muted);
  font-style: italic;
  text-align: center;
  padding: var(--spacing-lg);
}

.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  gap: var(--spacing-md);
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid var(--border-color);
  border-top-color: var(--accent-primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.loading p {
  color: var(--text-secondary);
  font-size: 1.1rem;
}

.error-message {
  padding: var(--spacing-lg);
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid var(--error);
  border-radius: var(--radius-md);
  animation: shake 0.5s ease-out;
}

.error-message h3 {
  color: var(--error);
  margin-bottom: var(--spacing-sm);
  font-size: 1.25rem;
}

.error-message p {
  color: var(--text-primary);
}

@keyframes shake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-10px);
  }
  75% {
    transform: translateX(10px);
  }
}

.no-response {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  padding: var(--spacing-lg);
  text-align: center;
}

.no-response p {
  color: var(--text-muted);
  font-size: 1.1rem;
}

.app-footer {
  padding: var(--spacing-md);
  text-align: center;
  background: var(--card-bg);
  backdrop-filter: blur(10px);
  border-top: 1px solid var(--border-color);
  color: var(--text-muted);
  font-size: 0.875rem;
}

::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: var(--secondary-bg);
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--accent-primary);
}

/* ══════════════════════════════════════════════════════════
   TAB NAVIGATION
══════════════════════════════════════════════════════════ */
.app-tab-nav {
  display: flex;
  gap: 0;
  background: var(--secondary-bg);
  border-bottom: 2px solid var(--border-color);
  padding: 0 var(--spacing-md);
}

.tab-btn {
  padding: 0.75rem 1.5rem;
  font-size: 0.95rem;
  font-weight: 600;
  background: transparent;
  color: var(--text-muted);
  border: none;
  border-bottom: 2px solid transparent;
  border-radius: 0;
  text-transform: none;
  letter-spacing: 0;
  cursor: pointer;
  transition: color var(--transition-base), border-color var(--transition-base);
  margin-bottom: -2px;
}

.tab-btn:hover {
  color: var(--text-primary);
  transform: none;
}

.tab-active {
  color: var(--accent-primary) !important;
  border-bottom-color: var(--accent-primary) !important;
}

/* ══════════════════════════════════════════════════════════
   SCHEME PAGE
══════════════════════════════════════════════════════════ */
.scheme-page {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 42px); /* below tab nav */
  background: var(--primary-bg);
  overflow: hidden;
}

/* ── Toolbar ── */
.scheme-toolbar {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: 0.75rem var(--spacing-lg);
  background: var(--card-bg);
  border-bottom: 1px solid var(--border-color);
  flex-wrap: wrap;
}

.scheme-toolbar-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-primary);
  letter-spacing: 0.03em;
  margin-right: auto;
}

.scheme-size-controls {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.scheme-size-controls label {
  font-size: 0.8rem;
  color: var(--text-secondary);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.scheme-size-controls input {
  width: 60px;
  padding: 0.35rem 0.6rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 0.9rem;
  text-align: center;
}

.scheme-size-controls input:focus {
  outline: none;
  border-color: var(--accent-primary);
}

.scheme-toolbar-right {
  display: flex;
  gap: 0.5rem;
}

.tb-btn {
  padding: 0.4rem 0.9rem;
  font-size: 0.8rem;
  font-weight: 600;
  border-radius: var(--radius-sm);
  cursor: pointer;
  border: 1px solid transparent;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  transition: all var(--transition-fast);
}

.tb-cycle {
  background: rgba(99, 102, 241, 0.15);
  color: var(--accent-primary);
  border-color: var(--accent-primary);
}

.tb-cycle:hover {
  background: var(--accent-primary);
  color: #fff;
  transform: translateY(-1px);
}

.tb-delete {
  background: rgba(239, 68, 68, 0.12);
  color: var(--error);
  border-color: var(--error);
}

.tb-delete:hover {
  background: var(--error);
  color: #fff;
  transform: translateY(-1px);
}

.tb-clear {
  background: rgba(148, 163, 184, 0.08);
  color: var(--text-secondary);
  border-color: var(--border-color);
}

.tb-clear:hover {
  background: var(--secondary-bg);
  color: var(--text-primary);
  transform: translateY(-1px);
}

/* ── Info bar for selected room ── */
.scheme-info-bar {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.4rem var(--spacing-lg);
  background: rgba(99, 102, 241, 0.07);
  border-bottom: 1px solid rgba(99, 102, 241, 0.2);
  font-size: 0.875rem;
  color: var(--text-primary);
  animation: fadeIn 0.2s ease-out;
}

.sib-icon { display: flex; align-items: center; }
.sib-sep { color: var(--text-muted); }

/* ── Workspace ── */
.scheme-workspace {
  flex: 1;
  display: flex;
  gap: var(--spacing-md);
  padding: var(--spacing-md);
  overflow: hidden;
}

/* ── CSS Grid ── */
.scheme-grid {
  flex: 1;
  display: grid;
  gap: 3px;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  padding: 6px;
  overflow: auto;
  -webkit-user-select: none;
  user-select: none;
}

/* Free cell */
.scheme-cell {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(148, 163, 184, 0.1);
  border-radius: 3px;
  min-width: 36px;
  min-height: 36px;
  cursor: crosshair;
  transition: background var(--transition-fast), border-color var(--transition-fast);
}

.scheme-cell:hover {
  background: rgba(99, 102, 241, 0.08);
  border-color: rgba(99, 102, 241, 0.3);
}

.scheme-cell-selected {
  background: rgba(99, 102, 241, 0.22) !important;
  border-color: var(--accent-primary) !important;
}

/* Room cell */
.scheme-room {
  border: 2px solid;
  border-radius: var(--radius-sm);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  cursor: pointer;
  transition:
    box-shadow var(--transition-base),
    border-color var(--transition-base),
    background var(--transition-base);
  overflow: hidden;
  padding: 8px;
  position: relative;
}

.scheme-room:hover {
  box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
}

.scheme-room-selected {
  box-shadow:
    0 0 0 3px rgba(241, 245, 249, 0.4),
    0 0 20px rgba(99, 102, 241, 0.3) !important;
}

.scheme-room-name {
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--text-primary);
  text-align: center;
  word-break: break-word;
  max-width: 100%;
}

.scheme-room-icon {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ── Icon animation states ── */

/* Idle: no animation */

/* Active: Mroźnia spins, Komora glows */
.anim-active .mroznia-icon {
  animation: spin-slow 4s linear infinite;
}

.anim-active .komora-icon {
  filter: drop-shadow(0 0 6px #8b5cf6);
  animation: glow-pulse 2s ease-in-out infinite;
}

/* Warning: slow pulse for both */
.anim-warning .room-icon {
  animation: warn-pulse 1.2s ease-in-out infinite;
}

/* Alarm: fast red flash for both */
.anim-alarm .room-icon {
  animation: alarm-flash 0.5s ease-in-out infinite;
}

@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

@keyframes glow-pulse {
  0%, 100% { filter: drop-shadow(0 0 4px #8b5cf6); }
  50%       { filter: drop-shadow(0 0 12px #8b5cf6); }
}

@keyframes warn-pulse {
  0%, 100% { opacity: 1;   filter: none; }
  50%       { opacity: 0.5; filter: drop-shadow(0 0 6px #f59e0b); }
}

@keyframes alarm-flash {
  0%, 100% { filter: drop-shadow(0 0 3px #ef4444); opacity: 1; }
  50%       { filter: drop-shadow(0 0 14px #ef4444); opacity: 0.6; }
}

/* ── Create room panel ── */
.scheme-panel-wrap {
  width: 300px;
  flex-shrink: 0;
  animation: slideLeft 0.2s ease-out;
}

@keyframes slideLeft {
  from { opacity: 0; transform: translateX(20px); }
  to   { opacity: 1; transform: translateX(0); }
}

.create-panel {
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  padding: var(--spacing-md);
  height: 100%;
  overflow-y: auto;
}

.create-panel-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 0.3rem;
}

.create-panel-info {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: var(--spacing-md);
}

.create-panel-field {
  margin-bottom: var(--spacing-md);
}

.create-panel-field label {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.4rem;
}

.create-panel-field input {
  width: 100%;
  padding: 0.6rem 0.8rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 0.9rem;
}

.create-panel-field input:focus {
  outline: none;
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.15);
}

/* Room type picker grid */
.room-type-picker {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.5rem;
}

.room-type-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 0.6rem 0.4rem;
  background: rgba(255, 255, 255, 0.03);
  border: 1.5px solid var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  font-size: 0.82rem;
  font-weight: 600;
  color: var(--text-primary);
  transition: all var(--transition-fast);
}

.room-type-option:hover {
  background: rgba(99, 102, 241, 0.08);
  border-color: var(--accent-primary);
  transform: translateY(-1px);
}

.room-type-option.selected {
  box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);
}

.rto-icon { display: flex; align-items: center; }
.rto-label { font-size: 0.78rem; text-align: center; }

.create-panel-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: var(--spacing-md);
}

.create-confirm-btn {
  flex: 1;
  padding: 0.6rem;
  background: var(--accent-gradient);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  font-weight: 700;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.create-confirm-btn:hover {
  transform: translateY(-1px);
  box-shadow: var(--glow);
}

.create-cancel-btn {
  padding: 0.6rem 1rem;
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  font-size: 0.9rem;
  cursor: pointer;
  transition: all var(--transition-fast);
  text-transform: uppercase;
}

.create-cancel-btn:hover {
  border-color: var(--error);
  color: var(--error);
}

/* ── Legend ── */
.scheme-legend {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  padding: 0.5rem var(--spacing-lg);
  background: var(--card-bg);
  border-top: 1px solid var(--border-color);
  font-size: 0.8rem;
  flex-wrap: wrap;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
  color: var(--text-secondary);
}

.legend-states {
  display: flex;
  gap: 0.4rem;
  margin-left: auto;
}

/* State pills */
.state-pill-idle    { background: rgba(148,163,184,0.15); color: #94a3b8; }
.state-pill-active  { background: rgba(6,182,212,0.15);   color: #06b6d4; }
.state-pill-warning { background: rgba(245,158,11,0.15);  color: #f59e0b; }
.state-pill-alarm   { background: rgba(239,68,68,0.15);   color: #ef4444; }

.legend-state, [class*="state-pill-"] {
  padding: 0.15rem 0.55rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}


/* ══════ APP LOADING ══════ */
.app-loading { display:flex; align-items:center; justify-content:center; height:100vh; background:var(--primary-bg); }

/* ══════ BUILDING INFO BADGE ══════ */
.building-info-badge { display:inline-flex; align-items:center; gap:.4rem; margin-top:.5rem; padding:.3rem .9rem; background:rgba(99,102,241,.1); border:1px solid rgba(99,102,241,.3); border-radius:9999px; font-size:.82rem; color:var(--text-secondary); }
.bib-label{color:var(--text-muted)}.bib-value{color:var(--accent-primary);font-family:'Fira Code',monospace;font-weight:600}.bib-sep{color:var(--text-muted)}

/* ══════ TAB BACK BUTTON ══════ */
.tab-building-label { margin-left:auto; font-size:.85rem; color:var(--text-secondary); padding:0 .5rem; }
.tab-back-btn { padding:.4rem .9rem; font-size:.82rem; font-weight:600; background:transparent; color:var(--text-muted); border:1px solid var(--border-color); border-radius:var(--radius-sm); cursor:pointer; text-transform:none; letter-spacing:0; transition:all var(--transition-fast); margin:.35rem 0; }
.tab-back-btn:hover { color:var(--accent-primary); border-color:var(--accent-primary); transform:none; }

/* ══════ LOGIN PAGE ══════ */
.login-page { min-height:100vh; display:flex; align-items:center; justify-content:center; background:var(--primary-bg); }
.login-card { width:100%; max-width:420px; padding:var(--spacing-xl); background:var(--card-bg); backdrop-filter:blur(20px); border:1px solid var(--border-color); border-radius:var(--radius-lg); box-shadow:var(--shadow-lg); animation:slideDown .5s ease-out; }
.login-logo { text-align:center; margin-bottom:var(--spacing-lg); }
.login-logo-icon { display:block; font-size:2.5rem; margin-bottom:.5rem; filter:drop-shadow(0 0 12px #06b6d4); }
.login-logo h1 { font-size:1.75rem; font-weight:700; background:var(--accent-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.login-logo p { color:var(--text-muted); font-size:.875rem; margin-top:.25rem; }
.login-tabs { display:flex; border-bottom:1px solid var(--border-color); margin-bottom:var(--spacing-md); }
.login-tab { flex:1; padding:.6rem; background:transparent; border:none; border-bottom:2px solid transparent; color:var(--text-muted); font-size:.9rem; font-weight:600; cursor:pointer; text-transform:none; letter-spacing:0; transition:all var(--transition-fast); margin-bottom:-1px; border-radius:0; }
.login-tab:hover{color:var(--text-primary);transform:none} .login-tab.active{color:var(--accent-primary);border-bottom-color:var(--accent-primary)}
.login-form{display:flex;flex-direction:column;gap:var(--spacing-md)}
.login-field{display:flex;flex-direction:column;gap:.4rem}
.login-field label{font-size:.82rem;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.05em}
.login-field input{padding:.75rem 1rem;background:var(--secondary-bg);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-primary);font-size:1rem;transition:all var(--transition-base)}
.login-field input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 3px rgba(99,102,241,.1)}
.login-submit{padding:.85rem;background:var(--accent-gradient);color:white;border:none;border-radius:var(--radius-md);font-size:1rem;font-weight:700;cursor:pointer;transition:all var(--transition-base);text-transform:uppercase;letter-spacing:.05em}
.login-submit:hover:not(:disabled){transform:translateY(-2px);box-shadow:var(--glow)} .login-submit:disabled{opacity:.6;cursor:not-allowed}
.login-error{padding:.65rem 1rem;background:rgba(239,68,68,.1);border:1px solid var(--error);border-radius:var(--radius-sm);color:var(--error);font-size:.875rem}

/* ══════ BUILDINGS PAGE ══════ */
.buildings-page{min-height:100vh;background:var(--primary-bg);padding:var(--spacing-xl) var(--spacing-lg)}
.buildings-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:var(--spacing-xl);flex-wrap:wrap;gap:var(--spacing-md)}
.buildings-header h1{font-size:2rem;font-weight:700;background:var(--accent-gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.buildings-subtitle{color:var(--text-muted);font-size:.9rem;margin-top:.25rem}
.buildings-header-actions{display:flex;gap:.75rem;align-items:center}
.buildings-add-btn{padding:.65rem 1.25rem;background:var(--accent-gradient);color:white;border:none;border-radius:var(--radius-md);font-size:.9rem;font-weight:700;cursor:pointer;transition:all var(--transition-base);text-transform:none;letter-spacing:0}
.buildings-add-btn:hover{transform:translateY(-2px);box-shadow:var(--glow)}
.buildings-logout-btn{padding:.65rem 1rem;background:transparent;border:1px solid var(--border-color);border-radius:var(--radius-md);color:var(--text-muted);font-size:.9rem;cursor:pointer;transition:all var(--transition-base);text-transform:none;letter-spacing:0}
.buildings-logout-btn:hover{border-color:var(--error);color:var(--error);transform:none}
.buildings-error{padding:.75rem 1rem;background:rgba(239,68,68,.1);border:1px solid var(--error);border-radius:var(--radius-sm);color:var(--error);margin-bottom:var(--spacing-lg)}
.buildings-loading{display:flex;justify-content:center;padding:var(--spacing-xl)}
.buildings-empty{text-align:center;padding:var(--spacing-xl);color:var(--text-muted);font-size:1.1rem}
.buildings-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--spacing-lg)}
.building-card{display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition-base);position:relative}
.building-card:hover{border-color:var(--accent-primary);transform:translateY(-3px);box-shadow:var(--shadow-md),var(--glow)}
.building-card-icon{font-size:2.5rem;line-height:1;flex-shrink:0}
.building-card-info{flex:1;min-width:0}
.building-card-name{font-size:1.1rem;font-weight:700;color:var(--text-primary);margin-bottom:.25rem}
.building-card-ip{display:block;font-family:'Fira Code',monospace;font-size:.8rem;color:var(--accent-primary)}
.building-card-user{display:block;font-size:.78rem;color:var(--text-muted);margin-top:.15rem}
.building-card-actions{display:flex;gap:.3rem;flex-direction:column}
.bca-edit,.bca-delete{background:transparent;border:1px solid var(--border-color);border-radius:var(--radius-sm);padding:.3rem .5rem;cursor:pointer;font-size:.9rem;transition:all var(--transition-fast);text-transform:none;letter-spacing:0}
.bca-edit:hover{border-color:var(--accent-primary);transform:none} .bca-delete:hover{border-color:var(--error);transform:none}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn .15s ease-out}
.modal-box{width:100%;max-width:460px;background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-lg);padding:var(--spacing-lg);box-shadow:var(--shadow-lg);animation:slideDown .2s ease-out}
.modal-box h2{font-size:1.25rem;font-weight:700;color:var(--text-primary);margin-bottom:var(--spacing-md)}
.modal-field{margin-bottom:var(--spacing-sm)}
.modal-field label{display:block;font-size:.8rem;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.05em;margin-bottom:.3rem}
.modal-field input{width:100%;padding:.65rem .9rem;background:var(--secondary-bg);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-primary);font-size:.95rem}
.modal-field input:focus{outline:none;border-color:var(--accent-primary);box-shadow:0 0 0 2px rgba(99,102,241,.15)}
.modal-actions{display:flex;gap:.5rem;margin-top:var(--spacing-md)}
.modal-save{flex:1;padding:.65rem;background:var(--accent-gradient);color:white;border:none;border-radius:var(--radius-sm);font-weight:700;font-size:.9rem;cursor:pointer;transition:all var(--transition-fast);text-transform:uppercase;letter-spacing:.04em}
.modal-save:hover:not(:disabled){transform:translateY(-1px);box-shadow:var(--glow)} .modal-save:disabled{opacity:.6;cursor:not-allowed}
.modal-cancel{padding:.65rem 1rem;background:transparent;border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-muted);font-size:.9rem;cursor:pointer;transition:all var(--transition-fast);text-transform:uppercase}
.modal-cancel:hover{border-color:var(--error);color:var(--error);transform:none}

/* ══════ SCHEME SIDEBAR ══════ */
.scheme-sidebar{width:200px;flex-shrink:0;background:var(--card-bg);border:1px solid var(--border-color);border-radius:var(--radius-md);display:flex;flex-direction:column;overflow:hidden}
.scheme-sidebar-header{display:flex;align-items:center;justify-content:space-between;padding:.6rem .75rem;border-bottom:1px solid var(--border-color);font-size:.8rem;font-weight:700;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.05em}
.sidebar-new-btn{background:rgba(99,102,241,.15);color:var(--accent-primary);border:1px solid rgba(99,102,241,.3);border-radius:var(--radius-sm);padding:.1rem .5rem;font-size:1.1rem;font-weight:600;cursor:pointer;line-height:1.2;transition:all var(--transition-fast);text-transform:none;letter-spacing:0}
.sidebar-new-btn:hover{background:var(--accent-primary);color:white;transform:none} .sidebar-new-btn:disabled{opacity:.4;cursor:not-allowed}
.sidebar-empty{padding:var(--spacing-sm);color:var(--text-muted);font-size:.8rem;text-align:center;font-style:italic}
.sidebar-item{display:flex;align-items:center;gap:.3rem;padding:.55rem .75rem;cursor:pointer;border-bottom:1px solid rgba(148,163,184,.06);transition:background var(--transition-fast);min-height:40px}
.sidebar-item:hover{background:rgba(99,102,241,.06)} .sidebar-item-active{background:rgba(99,102,241,.13)!important;border-left:2px solid var(--accent-primary)}
.sidebar-item-name{flex:1;font-size:.82rem;color:var(--text-primary);word-break:break-word;min-width:0}
.sidebar-rename-input{flex:1;padding:.25rem .4rem;background:var(--secondary-bg);border:1px solid var(--accent-primary);border-radius:3px;color:var(--text-primary);font-size:.82rem;min-width:0}
.sidebar-item-actions{display:flex;gap:.15rem;opacity:0;transition:opacity var(--transition-fast)}
.sidebar-item:hover .sidebar-item-actions{opacity:1}
.sidebar-item-actions button{background:transparent;border:none;cursor:pointer;padding:.1rem;font-size:.8rem;line-height:1;border-radius:3px;text-transform:none;letter-spacing:0;transition:background var(--transition-fast)}
.sidebar-item-actions button:hover{background:rgba(255,255,255,.08);transform:none}
.save-status{font-size:.75rem;font-weight:600;padding:.15rem .6rem;border-radius:9999px;border:1px solid}
.save-status-saved{color:var(--success);border-color:rgba(16,185,129,.3);background:rgba(16,185,129,.08)}
.save-status-saving{color:var(--warning);border-color:rgba(245,158,11,.3);background:rgba(245,158,11,.08)}
.save-status-unsaved{color:var(--error);border-color:rgba(239,68,68,.3);background:rgba(239,68,68,.08)}
.scheme-no-active{flex:1;display:flex;align-items:center;justify-content:center;color:var(--text-muted);font-size:1rem;background:var(--secondary-bg);border:1px solid var(--border-color);border-radius:var(--radius-md)}
.scheme-loading{flex:1;display:flex;align-items:center;justify-content:center}

/* ══════════════════════════════════════════════════════════
   DASHBOARD PAGE
══════════════════════════════════════════════════════════ */
.dashboard-page {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 42px);
  background: var(--primary-bg);
  overflow-y: auto;
  padding: var(--spacing-md) var(--spacing-lg) var(--spacing-lg);
  gap: var(--spacing-md);
}

.dashboard-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--spacing-sm);
}

.dashboard-title {
  font-size: 1.5rem;
  font-weight: 700;
  background: var(--accent-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.dashboard-sub {
  font-size: 0.82rem;
  color: var(--text-muted);
  font-family: 'Fira Code', monospace;
  margin-top: 0.15rem;
}

.dashboard-updated {
  font-size: 0.78rem;
  color: var(--text-muted);
  padding: 0.25rem 0.75rem;
  border: 1px solid var(--border-color);
  border-radius: 9999px;
}

/* ── Stats strip ── */
.dash-stats-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--spacing-sm);
}

.dash-stat-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-md);
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-top: 3px solid var(--stat-color, var(--accent-primary));
  border-radius: var(--radius-md);
  gap: 0.25rem;
  transition: transform var(--transition-base), box-shadow var(--transition-base);
}

.dash-stat-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.dash-stat-value {
  font-size: 2rem;
  font-weight: 800;
  color: var(--stat-color, var(--accent-primary));
  line-height: 1;
}

.dash-stat-label {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ── Three panel grid ── */
.dash-panels {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-md);
  flex: 1;
  min-height: 0;
}

.dash-panel {
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-lg);
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.dash-panel-hdr {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem var(--spacing-md);
  border-bottom: 1px solid var(--border-color);
  background: rgba(255,255,255,0.02);
  flex-shrink: 0;
}

.dash-panel-hdr h3 {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
  flex: 1;
}

.dph-icon { font-size: 1.1rem; }

.dph-count {
  font-size: 0.75rem;
  color: var(--text-muted);
  padding: 0.1rem 0.5rem;
  border: 1px solid var(--border-color);
  border-radius: 9999px;
}

.dph-conn {
  font-size: 0.75rem;
  font-weight: 600;
  padding: 0.1rem 0.5rem;
  border-radius: 9999px;
  border: 1px solid;
}
.dph-conn-ok    { color: var(--success); border-color: rgba(16,185,129,0.4); }
.dph-conn-error { color: var(--error);   border-color: rgba(239,68,68,0.4); }

.dash-panel-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--spacing-sm);
}

/* ── Helpers ── */
.dash-center {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: var(--spacing-sm);
  text-align: center;
  color: var(--text-muted);
  min-height: 120px;
}

.dash-empty {
  text-align: center;
  color: var(--text-muted);
  font-size: 0.85rem;
  padding: var(--spacing-md);
  line-height: 1.6;
}

.dash-empty-small { color: var(--text-muted); font-size: 0.8rem; font-style: italic; }

.dash-error-banner {
  padding: 0.6rem 0.75rem;
  background: rgba(239,68,68,0.1);
  border: 1px solid var(--error);
  border-radius: var(--radius-sm);
  color: var(--error);
  font-size: 0.82rem;
  margin-bottom: var(--spacing-sm);
}

/* ── Refresh button ── */
.dash-fetch-btn {
  padding: 0.2rem 0.65rem;
  font-size: 0.78rem;
  font-weight: 600;
  background: rgba(99,102,241,0.12);
  color: var(--accent-primary);
  border: 1px solid rgba(99,102,241,0.35);
  border-radius: var(--radius-sm);
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dash-fetch-btn:hover { background: var(--accent-primary); color: white; transform: none; }
.dash-fetch-btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* ── Room list (Chłodnictwo panel) ── */
.drooms-list { display: flex; flex-direction: column; gap: 0.4rem; }

.droom-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: 0.55rem 0.75rem;
  border-left: 3px solid;
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  transition: filter var(--transition-fast);
}
.droom-item:hover { filter: brightness(1.15); }

.dri-icon { display: flex; align-items: center; flex-shrink: 0; }

.dri-info {
  display: flex;
  flex-direction: column;
  gap: 0.1rem;
  flex: 1;
  min-width: 0;
}

.dri-name   { font-size: 0.85rem; font-weight: 600; color: var(--text-primary); }
.dri-type   { font-size: 0.72rem; color: var(--text-muted); }
.dri-scheme { font-size: 0.7rem;  color: var(--text-muted); opacity: 0.7; }

.dri-badge {
  display: flex;
  align-items: center;
  gap: 0.3rem;
  font-size: 0.72rem;
  font-weight: 700;
  border: 1px solid;
  border-radius: 9999px;
  padding: 0.1rem 0.5rem;
  flex-shrink: 0;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.dri-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* ── Alarms panel ── */
.dash-alarm-prompt {
  flex-direction: column;
  gap: var(--spacing-sm);
}

.dash-state-alerts {
  margin-bottom: var(--spacing-sm);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  overflow: hidden;
}

.dsa-title {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: 0.35rem 0.6rem;
  background: rgba(255,255,255,0.03);
  border-bottom: 1px solid var(--border-color);
}

.dsa-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.3rem;
  padding: 0.45rem 0.7rem;
  font-size: 0.82rem;
  border-bottom: 1px solid rgba(148,163,184,0.05);
}

.dsa-alarm   { color: var(--error);   background: rgba(239,68,68,0.07);  }
.dsa-warning { color: var(--warning); background: rgba(245,158,11,0.07); }

.dsa-row strong { flex: 1; }
.dsa-row span   { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; border: 1px solid; padding: 0.07rem 0.4rem; border-radius: 9999px; }
.dsa-alarm   span { border-color: var(--error);   }
.dsa-warning span { border-color: var(--warning); }

.dalarm-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.3rem; }

.dalarm-item {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  padding: 0.5rem 0.6rem;
  background: rgba(239,68,68,0.07);
  border-left: 2px solid var(--error);
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
  font-size: 0.82rem;
}
.dalarm-ico { color: var(--error); flex-shrink: 0; }
.dalarm-txt { color: var(--text-primary); word-break: break-word; font-family: 'Fira Code', monospace; font-size: 0.75rem; }

/* ── Inne panel ── */
.dinfo-list {
  display: flex;
  flex-direction: column;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: var(--spacing-sm);
}

.dinfo-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.45rem 0.75rem;
  font-size: 0.82rem;
  border-bottom: 1px solid rgba(148,163,184,0.07);
}
.dinfo-row:last-child { border-bottom: none; }

.dinfo-key { color: var(--text-muted); font-size: 0.78rem; }
.dinfo-val { color: var(--text-primary); font-weight: 600; text-align: right; }
.dinfo-val.mono { font-family: 'Fira Code', monospace; color: var(--accent-primary); font-weight: normal; }

.dscheme-summary {
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  overflow: hidden;
  margin-bottom: var(--spacing-sm);
}

.dss-title {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: 0.35rem 0.6rem;
  background: rgba(255,255,255,0.03);
  border-bottom: 1px solid var(--border-color);
}

.dss-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.4rem 0.75rem;
  font-size: 0.82rem;
  color: var(--text-primary);
  border-bottom: 1px solid rgba(148,163,184,0.06);
}
.dss-row:last-child { border-bottom: none; }
.dss-count { color: var(--text-muted); font-size: 0.75rem; }

.dstate-breakdown {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
}

.dsb-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.82rem;
  padding: 0.25rem 0;
}

.dsb-dot { width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0; }
.dsb-label { flex: 1; }
.dsb-count { font-weight: 700; font-size: 0.9rem; }

/* Responsive: collapse to 1 column on narrow screens */
@media (max-width: 900px) {
  .dash-panels { grid-template-columns: 1fr; }
  .dash-stats-row { grid-template-columns: repeat(2, 1fr); }
}

/* ══════ 2×2 DASHBOARD GRID ══════ */
.dash-panels-2x2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  gap: var(--spacing-md);
  flex: 1;
  min-height: 0;
}

/* ── Panel header extras ── */
.dph-cmd {
  font-family: 'Fira Code', monospace;
  font-size: 0.68rem;
  color: var(--text-muted);
  background: rgba(148,163,184,0.1);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: 0.05rem 0.45rem;
  white-space: nowrap;
}

.dp-meta {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 0.72rem;
  flex-shrink: 0;
}
.dpm-loading { color: var(--text-muted); }
.dpm-error   { color: var(--error);      }
.dpm-ok      { color: var(--success); font-weight: 600; }

/* ── Val data table ── */
.dp-table-wrap {
  overflow: auto;
  max-height: 100%;
}

.dp-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.78rem;
}

.dp-table thead tr {
  background: rgba(99,102,241,0.1);
  border-bottom: 1px solid var(--border-color);
}

.dp-table th {
  padding: 0.35rem 0.6rem;
  text-align: left;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  font-size: 0.7rem;
  white-space: nowrap;
}

.dp-table tbody tr {
  border-bottom: 1px solid rgba(148,163,184,0.06);
  transition: background var(--transition-fast);
}

.dp-table tbody tr:hover { background: rgba(99,102,241,0.05); }

.dp-table td {
  padding: 0.4rem 0.6rem;
  color: var(--text-primary);
  vertical-align: middle;
}

.dp-cell-n      { color: var(--text-muted); font-size: 0.7rem; width: 2rem; }
.dp-cell-descr  { max-width: 200px; word-break: break-word; }
.dp-cell-val    { font-family: 'Fira Code', monospace; font-weight: 700; color: var(--accent-primary); white-space: nowrap; }
.dp-cell-unit   { color: var(--text-muted); font-size: 0.72rem; white-space: nowrap; }
.dp-cell-state  { font-size: 0.72rem; color: var(--text-muted); }

.dp-row-active td { background: rgba(6,182,212,0.06); }
.dp-row-active .dp-cell-state { color: var(--success); font-weight: 600; }

/* ── Refresh countdown ── */
.refresh-countdown {
  margin-top: var(--spacing-md);
  padding: var(--spacing-sm);
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
}

.rc-label {
  font-size: 0.78rem;
  color: var(--text-muted);
  margin-bottom: 0.4rem;
}

.rc-label strong { color: var(--accent-primary); }

.rc-bar {
  height: 4px;
  background: rgba(148,163,184,0.15);
  border-radius: 9999px;
  overflow: hidden;
}

.rc-fill {
  height: 100%;
  background: var(--accent-gradient);
  border-radius: 9999px;
  transition: width 1s linear;
}

/* Responsive */
@media (max-width: 900px) {
  .dash-panels-2x2 { grid-template-columns: 1fr; grid-template-rows: auto; }
}

/* ══════ DASHBOARD PANEL — VIEW TOGGLE & RAW XML ══════ */
.dp-view-toggle {
  display: flex;
  gap: 2px;
  padding: 0.3rem 0.3rem 0;
  flex-shrink: 0;
}

.dp-vtbtn {
  padding: 0.2rem 0.65rem;
  font-size: 0.72rem;
  font-weight: 600;
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dp-vtbtn.active { background: rgba(99,102,241,0.15); color: var(--accent-primary); border-color: rgba(99,102,241,0.4); }
.dp-vtbtn:hover:not(.active) { color: var(--text-primary); transform: none; }

.dp-raw {
  flex: 1;
  font-family: 'Fira Code', monospace;
  font-size: 0.72rem;
  color: var(--text-secondary);
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm);
  margin: 0.4rem 0.3rem 0.3rem;
  overflow: auto;
  white-space: pre-wrap;
  word-break: break-all;
  line-height: 1.5;
}

/* Extra attribute columns */
.dp-cell-tag   { font-family: 'Fira Code', monospace; font-size: 0.68rem; color: var(--text-muted); opacity: 0.8; }
.dp-cell-extra { font-size: 0.72rem; color: var(--text-secondary); }

/* ══════ DEVICE TABLE (Chłodnictwo panel) ══════ */
.dp-row-group td,
.dp-cell-group {
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--text-secondary);
  background: rgba(99,102,241,0.08);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  padding: 0.4rem 0.75rem !important;
}

.dp-status-badge {
  display: inline-block;
  font-size: 0.7rem;
  font-weight: 600;
  border: 1px solid;
  border-radius: 9999px;
  padding: 0.08rem 0.5rem;
  white-space: nowrap;
}

.dp-cell-alarm { font-size: 1rem; text-align: center; }

/* ══════════════════════════════════════════════════════════
   SCHEME PAGE v2 — PDF Canvas + Objects
══════════════════════════════════════════════════════════ */

/* ── Toolbar enhancements ── */
.scheme-tool-group {
  display: flex;
  gap: 2px;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: 2px;
}

.tb-tool-btn {
  padding: 0.3rem 0.85rem;
  font-size: 0.78rem;
  font-weight: 600;
  background: transparent;
  color: var(--text-muted);
  border: none;
  border-radius: calc(var(--radius-sm) - 2px);
  cursor: pointer;
  letter-spacing: 0;
  text-transform: none;
  transition: all var(--transition-fast);
}
.tb-tool-btn:hover { color: var(--text-primary); transform: none; }
.tb-tool-btn.active {
  background: rgba(99,102,241,0.2);
  color: var(--accent-primary);
}

.scheme-opacity-control {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.78rem;
  color: var(--text-secondary);
}
.scheme-opacity-control input[type=range] {
  width: 100px;
  accent-color: var(--accent-primary);
  cursor: pointer;
}

.tb-upload-btn {
  padding: 0.35rem 0.85rem;
  font-size: 0.78rem;
  font-weight: 600;
  background: rgba(99,102,241,0.12);
  color: var(--accent-primary);
  border: 1px solid rgba(99,102,241,0.3);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
  white-space: nowrap;
  letter-spacing: 0;
  text-transform: none;
}
.tb-upload-btn:hover { background: rgba(99,102,241,0.25); transform: none; }

/* ── Canvas area ── */
.scheme-canvas-wrap {
  flex: 1;
  overflow: hidden;
  position: relative;
  display: flex;
}

.scheme-canvas-container {
  flex: 1;
  position: relative;
  overflow: hidden;
  background: var(--secondary-bg);
}

.scheme-pdf-frame {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: none;
  pointer-events: none;
  transition: opacity 0.2s;
}

.scheme-canvas-empty {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  font-size: 0.9rem;
  border: 2px dashed var(--border-color);
  border-radius: var(--radius-md);
  margin: 1rem;
}

.scheme-svg-overlay {
  position: absolute;
  inset: 0;
  display: block;
}
.scheme-svg-overlay.tool-room  { cursor: crosshair; }
.scheme-svg-overlay.tool-device { cursor: cell; }
.scheme-svg-overlay.tool-select { cursor: default; }

/* ── Device picker dialog ── */
.device-picker-dialog {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  min-width: 320px;
}

.dpd-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 0.25rem;
}

.dpd-info {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-top: -0.5rem;
}

.dpd-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.5rem;
}

.dpd-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.3rem;
  padding: 0.5rem 0.25rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: 0.68rem;
  color: var(--text-muted);
  transition: all var(--transition-fast);
  text-transform: none;
  letter-spacing: 0;
}
.dpd-option:hover { border-color: var(--accent-primary); color: var(--text-primary); transform: none; }
.dpd-option.selected { border-color: #38bdf8; background: rgba(56,189,248,0.1); color: #38bdf8; }

.dpd-color-row {
  display: flex;
  gap: 0.5rem;
}

.dpd-color-swatch {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: transform var(--transition-fast);
  padding: 0;
  text-transform: none;
}
.dpd-color-swatch:hover { transform: scale(1.15); }
.dpd-color-swatch.selected { outline: 2px solid #f1f5f9; outline-offset: 2px; }

.dpd-field {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
}
.dpd-field label { font-size: 0.78rem; color: var(--text-secondary); font-weight: 500; text-transform: none; }
.dpd-field input, .dpd-field select {
  padding: 0.45rem 0.7rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 0.875rem;
  font-family: inherit;
}
.dpd-field input:focus, .dpd-field select:focus {
  outline: none;
  border-color: var(--accent-primary);
}

.dpd-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
}

.dpd-confirm {
  padding: 0.45rem 1.2rem;
  background: var(--accent-primary);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  font-weight: 600;
  font-size: 0.875rem;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dpd-confirm:hover { background: var(--accent-secondary); transform: translateY(-1px); }

.dpd-cancel {
  padding: 0.45rem 1rem;
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 0.875rem;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dpd-cancel:hover { color: var(--text-primary); transform: none; }

/* ── Detail panel (right sidebar) ── */
.detail-panel {
  width: 270px;
  flex-shrink: 0;
  background: var(--card-bg);
  border-left: 1px solid var(--border-color);
  padding: 0.75rem;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  overflow-y: auto;
}

.dp-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.dp-kind-badge {
  font-size: 0.72rem;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}
.dp-close-btn {
  padding: 0.2rem 0.5rem;
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 0.75rem;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dp-close-btn:hover { color: var(--text-primary); transform: none; }

.dp-field {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
}
.dp-field label { font-size: 0.72rem; color: var(--text-secondary); font-weight: 500; }
.dp-field input, .dp-field select {
  padding: 0.4rem 0.6rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-size: 0.8rem;
  font-family: inherit;
}
.dp-field input:focus, .dp-field select:focus {
  outline: none; border-color: var(--accent-primary);
}

.dp-icon-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.35rem;
}
.dp-icon-opt {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.35rem;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition-fast);
  text-transform: none;
}
.dp-icon-opt:hover { border-color: #64748b; transform: none; }
.dp-icon-opt.selected { border-color: #38bdf8; background: rgba(56,189,248,0.1); }

.dp-section h4 {
  font-size: 0.72rem;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.4rem;
}

.dp-empty { font-size: 0.78rem; color: var(--text-muted); font-style: italic; }

.dp-checkboxes {
  display: flex;
  gap: 1rem;
  font-size: 0.8rem;
  color: var(--text-secondary);
}
.dp-checkboxes label { display: flex; align-items: center; gap: 0.35rem; cursor: pointer; }
.dp-checkboxes input[type=checkbox] { accent-color: var(--accent-primary); }

.dp-live-preview {
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: 0.6rem;
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
}
.dp-live-preview h4 {
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 0.2rem;
}
.dpv-row {
  display: flex;
  justify-content: space-between;
  font-size: 0.78rem;
}
.dpv-row span { color: var(--text-muted); }
.dpv-row strong { color: var(--text-primary); }
.dpv-alarm { font-size: 0.78rem; color: var(--error); font-weight: 700; }

.dp-actions {
  display: flex;
  gap: 0.4rem;
  margin-top: auto;
}
.dp-save-btn {
  flex: 1;
  padding: 0.45rem;
  background: var(--accent-primary);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  font-size: 0.78rem;
  font-weight: 600;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dp-save-btn:hover { background: var(--accent-secondary); transform: translateY(-1px); }

.dp-delete-btn {
  padding: 0.45rem 0.75rem;
  background: transparent;
  color: var(--error);
  border: 1px solid rgba(239,68,68,0.3);
  border-radius: var(--radius-sm);
  font-size: 0.78rem;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
}
.dp-delete-btn:hover { background: rgba(239,68,68,0.1); transform: none; }

/* ── Detail modal ── */
.detail-modal-box {
  min-width: 400px;
  max-width: 520px;
}
.detail-modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1rem;
}
.detail-modal-header h2 { font-size: 1.2rem; font-weight: 700; }
.detail-modal-header button {
  padding: 0.25rem 0.6rem;
  background: transparent;
  color: var(--text-muted);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-size: 0.8rem;
  cursor: pointer;
  text-transform: none;
}

.detail-modal-icon {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.4rem;
  margin-bottom: 1rem;
  color: var(--text-secondary);
  font-size: 0.85rem;
}

.detail-modal-data h4 {
  font-size: 0.8rem;
  color: var(--text-muted);
  font-weight: 600;
  margin-bottom: 0.5rem;
}
.detail-modal-data em { color: var(--accent-primary); font-style: normal; }

.dmd-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.4rem;
}
.dmd-row {
  display: flex;
  flex-direction: column;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: 0.4rem 0.6rem;
}
.dmd-key { font-size: 0.68rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; }
.dmd-val { font-size: 0.85rem; color: var(--text-primary); font-weight: 600; }
.alarm-val { color: var(--error); }

.detail-modal-empty {
  font-size: 0.85rem;
  color: var(--text-muted);
  font-style: italic;
  margin-bottom: 1rem;
}


/* ── PDF Canvas + Zoom (Scheme v2) ── */
.scheme-pdf-scroll {
  position: absolute;
  inset: 0;
  overflow: auto;
  display: flex;
  align-items: flex-start;
  justify-content: flex-start;
  transition: opacity 0.2s;
}

.pdf-canvas {
  display: block;
  max-width: none; /* allow wider than container when zoomed */
}

.pdf-render-error {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--error);
  font-size: 0.85rem;
}

/* Zoom controls in toolbar */
.scheme-zoom-control {
  display: flex;
  align-items: center;
  gap: 2px;
  background: var(--secondary-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  padding: 2px 4px;
}

.zoom-btn {
  padding: 0.2rem 0.55rem;
  font-size: 1rem;
  font-weight: 700;
  background: transparent;
  color: var(--text-secondary);
  border: none;
  border-radius: calc(var(--radius-sm) - 2px);
  cursor: pointer;
  transition: color var(--transition-fast), background var(--transition-fast);
  letter-spacing: 0;
  text-transform: none;
  line-height: 1;
}
.zoom-btn:hover { color: var(--text-primary); background: rgba(255,255,255,0.06); transform: none; }

.zoom-reset {
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  color: var(--text-muted);
}

.zoom-label {
  min-width: 42px;
  text-align: center;
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--text-secondary);
  user-select: none;
}

/* Detail panel — details open button */
.dp-details-btn {
  padding: 0.45rem 0.75rem;
  background: rgba(56,189,248,0.1);
  color: #38bdf8;
  border: 1px solid rgba(56,189,248,0.3);
  border-radius: var(--radius-sm);
  font-size: 0.78rem;
  cursor: pointer;
  text-transform: none;
  letter-spacing: 0;
  transition: all var(--transition-fast);
  white-space: nowrap;
}
.dp-details-btn:hover { background: rgba(56,189,248,0.2); transform: none; }
